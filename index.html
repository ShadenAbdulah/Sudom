<!DOCTYPE html>
<html>
<head>
  <title>Student Lookup</title>
</head>
<body>
  <h2>Enter Student ID</h2>
  <input type="text" id="studentId" placeholder="e.g., 12345" />
  <button onclick="lookup()">Search</button>

  <div id="result"></div>

  <script>
    async function lookup() {
      const id = document.getElementById('studentId').value;
      const url = `https://script.google.com/macros/s/AKfycbyVpc3rAgxvspws7d-OlZxr0LjZkpYKQqpZ0g3aCkhFJob2UrEXTdfCupg81Lhjws4J/exec?id=${id}`;

      try {
        const res = await fetch(url);
        const text = await res.text(); // Raw response as text
        console.log("Raw response:", text); // Log it
    
        let data;
        try {
          data = JSON.parse(text);
        } catch (e) {
          document.getElementById('result').innerHTML = `Unexpected response: <pre>${text}</pre>`;
          return;
        }
    
        if (data.error) {
          document.getElementById('result').innerHTML = `Error: ${data.error}`;
        } else {
          document.getElementById('result').innerHTML =
            `<p>Name: ${data.name}</p><p>Phone: ${data.phone}</p>`;
        }
      } catch (err) {
        document.getElementById('result').innerHTML = `Fetch error: ${err.message}`;
      }
    }
  </script>
</body>
</html>
